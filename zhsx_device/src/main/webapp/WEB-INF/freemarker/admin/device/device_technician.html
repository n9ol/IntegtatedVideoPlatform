<!DOCTYPE html>
<html lang="zh-CN">
	<head>
		<title>仁峰后台管理系统</title>
		<meta charset="utf-8">
		<meta name="renderer" content="webkit">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="format-detection" content="telephone=no">
		<#include "/commons/comAdmin.html" encoding="utf-8"/>	
	</head>
<body>
<section class="layui-larry-box">
	<div class="larry-personal">
	    <div class="layui-tab">
            
            <blockquote class="layui-elem-quote mylog-info-tit" style="height:60px;">
            	<a class="layui-btn pull-left" style="font-size:14px;padding-left:10px;padding-right:10px;" onclick="checkOrUpdate('${(l.id)!''}','1');"><i class="glyphicon glyphicon-plus"></i>添加技术人员</a>
            	
            	<a href="javascript:;" class="layui-btn search-btn01 pull-left" onclick="batchDel(2,0);"><i class="iconfont icon-shanchu1"></i>批量删除</a>
            </blockquote>
            
            <div class="larry-separate"></div>
		    <div class="layui-tab-content larry-personal-body clearfix">
				<table class="layui-table table-hover text-center" lay-even="">
                    <thead>
	                    <tr>
	                   		<th><input type="checkbox" id="selected-all-operation"></th>
            			    <th>名字</th>
	                        <th>电话</th>
	                        <th>操作</th>
	                    </tr>
                    </thead>
                    <tbody>
                       <#if dtList?exists && dtList?size != 0 >
                     	<#list dtList as l>
                     		<tr>
	                          	<td><input type="checkbox" name="del_id" value="${l.id!''}"></td>
	                            <td>${l.name!""}</td>
	                            <td>${l.phone!""}</td>
	                            <td>
	                                <a href="javascript:void(0);" onclick="checkOrUpdate('${(l.id)!''}','2');" title="编辑" class="check_look"><i class="layui-icon">&#xe642;</i>&nbsp;编辑</a>
	                                <a href="javascript:;" onclick="batchDel(1,'${l.id}');" title="删除" class="check_look"><i class="layui-icon">&#xe640;</i>&nbsp;删除</a>
	                            </td>
	                        </tr>
                     	</#list>
                    </#if>
                    </tbody>
                    
                </table> 
                <!-- 分页 -->
				<div id="pagerss"></div>
		    </div>
		</div>
	</div>
</section>

<script type="text/javascript">
	layui.use(['jquery', 'form','laypage'], function() {
		
		var form = layui.form();
		laypage = layui.laypage;
		
        laypage({
			cont : "pagerss",pages : "${pages!'1'}",curr : "${pageNum!'1'}",skip : false,skin : "molv",groups : 5,
			jump : function(e, first) {
				if (!first) {
					var province = $("#province").val();
					var city = $("#city").val();
					var area = $("#area").val();
					var schoolId = $("#schoolId").val();
					var deviceCode = $("#deviceCode").val(); 
					
					location.href="${ctx}/webdevicetechnician/admin/listDMBycontion?p="+e.curr;
				}
			}
		});
        
        
	});
	
	//全选
	$("#selected-all-operation").click(function() {
		if (this.checked) {
			$("input[name='del_id']").prop("checked", true);
		} else {
			$("input[name='del_id']").prop("checked", false);
		}
	});

	//批量删除
	function batchDel(state,id) {
			if(state==1){
				layer.confirm('你确定要删除吗?', {icon: 3, title:'提示'}, function(index){
					window.location.href="${ctx}/webdevicetechnician/admin/deviceDeleteDT?ids="+id;
					layer.close(index);
				});
			}else{
				var ids = "";
			    $('input:checkbox[name=del_id]:checked').each(function(i){
				    if(0==i){
				    	ids = $(this).val();
				    }else{
				    	ids += (","+$(this).val());
				    }
			    });
			    
				if (typeof (ids) != "undefined" && (ids.length!=0)) {
					layer.confirm('你确定要删除吗?', {icon: 3, title:'提示'}, function(index){
						window.location.href="${ctx}/webdevicetechnician/admin/deviceDeleteDT?ids="+ids;
						layer.close(index);
					});
				} else {
					layer.msg("请选择要操作的对象");
				}
			}
		
	}
	
	function checkOrUpdate(id,flag) {
		LayerOpen('编辑', '820px', '500px', '${ctx}/webdevicetechnician/admin/findDTById?id='+ id+"&flag="+flag);
	}

	
</script>
</body>
</html>