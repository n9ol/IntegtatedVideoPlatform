<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <title>答题统计</title>
        <meta name="renderer" content="webkit">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="format-detection" content="telephone=no">

         <#include "/commons/comAdmin.html" encoding="utf-8"/>
		<link rel="stylesheet" type="text/css" href="${ctx}/common/bootstrap/css/bootstrap.css" media="all">
        <link rel="stylesheet" type="text/css" href="${ctx}/common/global.css" media="all">
        <link rel="stylesheet" type="text/css" href="${ctx}/css/personal.css" media="all">
 
 
    </head>
<body>
<section class="layui-larry-box">
	<div class="larry-personal">
	    <div class="layui-tab">
            <blockquote class="layui-elem-quote mylog-info-tit" style="height:80px;">

                <form id='formMy' class="layui-form col-lg-9 search-box03" action="" method="post">
                    <div class="layui-input-inline pull-left">
                                    <input type="text" id="searchQuestion" name="searchQuestion" placeholder="题目" class="layui-input" value="${wq.searchQuestion!''}"/>
                    </div>
                     
                     <div class="layui-input-inline pull-left">   
           				<select id ="type" name="type" lay-verify="">
           				<#assign typa=''><#assign typb=''><#assign typc=''>
           				<#if (((wq.searchType)!'') == 'A')><#assign typa="selected='selected'"> </#if>
           				<#if (((wq.searchType)!'') == 'B')><#assign typb="selected='selected'"> </#if>
           				<#if (((wq.searchType)!'') == 'C')><#assign typc="selected='selected'"> </#if>
						  <option value="">请选择类型</option>
						  <option value="A"  ${typa} >单选题</option>
						  <option value="B"  ${typb} >多选题</option>
						  <option value="C"  ${typc} >判断题</option>
<!-- 						   <option value="D"  ${typb} >主观题</option> -->
						</select>            
                     </div> 
                    <!-- 试卷id -->
					<input type="hidden" id="lId" name="lId" value="${lId!''}">
					<input type="hidden" id="classId" name="classId" value="${classId!''}">
					<input type="hidden" id="classType" name="classType" value="${classType!''}">
					<input type="hidden" id="key" name="key" value="${key!''}">
                    <button class="layui-btn search-btn01 pull-left" lay-submit lay-filter="search">搜索</button>
                   <a class="layui-btn layui-btn-primary   pull-left" style="margin:0 30px 0 30px;" href="${ctx}/padPractice/detailedRecordPad?p=${pageNum!'1'}&lId=${lId!''}&classId=${classId!''}&classType=${classType}&key=${key}">
				    重置
				    </a>
                    
                </form>
<!-- 				<button class="layui-btn layui-btn-warm search-btn01 pull-left" onclick="add();">添加题目</button> -->
				
                <a class="layui-btn pull-left refresh_btn" style="margin:0 30px 0 30px;" href="${ctx}/padPractice/examRecordPad?classType=${classType}&key=${key}&p=1">
<!--                   <a class="layui-btn pull-left refresh_btn" style="margin:0 30px 0 30px;" href="javascript:history.back();"> -->
                    	返回课堂记录
                </a>
                <!-- 刷新功能 -->
				<a class="layui-btn pull-right refresh_btn" style="margin:0 30px 0 30px;" href="${ctx}/padPractice/detailedRecordPad?p=${pageNum!'1'}&lId=${lId!''}&classId=${classId!''}&classType=${classType}&key=${key}">
				    <i class="iconfont icon-shuaxin"></i>
				</a>
            </blockquote>
            <div class="larry-separate"></div>
            
            
            
		    <div class="layui-tab-content larry-personal-body clearfix">
		        
		       <div id='main'  style="width: 220px; height: 80px; display: none"></div>
                <table class="layui-table layui-table table-hover text-center" lay-even="" >
                    <thead>
	                    <tr>
	                        <th>No</th>
	                        <th>题目</th>
	                        <th>答题情况</th>
	                        <th>正确率</th>
<!-- 	                        <th>操作</th> -->
	                    </tr>
                    </thead>
                    <tbody id="the_myclass">
     					<#if lists?? && (lists?size>0)>
                       		<#list lists as l>
                       			<tr>
		                            <td>${(l_index+1)!''}</td>
<!-- 		                            <td style="width:800px; word-break: break-all; word-wrap:break-word;">${l.className!''}</td> -->
		                            <td>${l.question!''}</td>
		                            <td>  
										 <input type="hidden" data-xdata="${l.xAxisData!''}" data-ydata="${l.yAxisData!''}" class="main_main"  name="main_main" data-questiontype="${l.type!''}" data-idd="${(l.id)!''}" value="${(l.id)!''}"/>
										 
										 <div id="${(l.id)!''}"  style="width: 220px; height: 80px;"></div>
										 
										${l.answerStat!''} </td>
		                            <td> ${l.correctRate!''}%
									</td>
		                             
<!-- 		                            <td> -->
<!-- 		                                <a class="" title="删除" href="javascript:detailed('{(l.lId)!''}');"> -->
<!-- 		                                     		详细 -->
<!-- 		                                </a> -->
<!-- 		                            </td> -->
		                        </tr>
							</#list>
						</#if>
                    </tbody>
                </table>
                <div id="page"></div>
		    </div>
		</div>
	</div>
</section>
	<script type="text/javascript" src="${ctx}/common/layui/lay/modules/laypage.js"></script>
 
	<script type="text/javascript" src="${ctx}/common/echarts.min.js"></script>
<script type="text/javascript">


// 基于准备好的dom，初始化echarts实例
var myChart = echarts.init(document.getElementById("main"));
// 指定图表的配置项和数据
var option = {
		color: ['#3398DB'],
   tooltip: {},
 
   xAxis: {
       data: ["A","B","C","D","E"]
   },
   yAxis: {
	   minInterval: 1
	},
   series: [{
       name: '选择人数',
       type: 'bar',
       barWidth: '50%',
       data: [5, 23, 36, 10, 10]
   }]
};
// 使用刚指定的配置项和数据显示图表。
myChart.setOption(option);

$(document).ready(function(){
	var divs = $(".main_main")
	 for (var i = 0; i < divs.length; i++) {
		var jq = $(divs[i]);
		var inpId =jq.val();
		var xData=jq.data("xdata");
		var yData=jq.data("ydata");
		var questiontype=jq.data("questiontype");
		initEcharr(inpId,xData,yData,questiontype);
	}
	
});


function initEcharr(id,xData,yData,type){

var xd = xData.substring(1,xData.length-1);
var xarr = xd.split(',');
if(type=='C'){
	for (var i = 0; i < xarr.length; i++) {
		if("A"==$.trim(xarr[i])){
			xarr[i]="正确"
		}else if("B"==$.trim(xarr[i])){
			xarr[i]="错误"
		}
	}
}
	// 基于准备好的dom，初始化echarts实例
	 var myChart = echarts.init(document.getElementById(id));

	// 指定图表的配置项和数据
	var option = {
			color: ['#3398DB'],
	    tooltip: {},
	  
	    xAxis: {
	        data: xarr
	    },
	    yAxis: {
	    	minInterval: 1
		},
	    series: [{
	        name: '选择人数',
	        type: 'bar',
	        barWidth: '50%',
	        data: yData
	    }]
	};
	 
	// 使用刚指定的配置项和数据显示图表。
	myChart.setOption(option);
	
}


$(document).ready(function(){
	var tipsi;
	  $(".sse").hover(function(){
		  var aa=$(this).children('span').html();
		  if($(this).text().indexOf("...")>0)
	     tipsi = layer.tips(aa,this, {time:0});//
	   },function(){
			layer.close(tipsi);
	   });
 
});


     
	var $;
	var form;
	var $form; 
	
	layui.use(['jquery', 'form'], function() {
		$ = layui.jquery;
		form = layui.form();
		$form = $('form');
		
		
		form.on('submit(search)', function(data){
       	 var type = $("#type").val();
    	 var searchQuestion = $("#searchQuestion").val();
    	 var lId = $("#lId").val();
    	 var classId =$("#classId").val();
    	 var classType =$("#classType").val();
    	 var key =$("#key").val();
	     window.location.href="${ctx}/padPractice/detailedRecordPad?p=${pageNum!'1'}&searchType="+type+"&searchQuestion="+searchQuestion+"&lId="+lId+"&classId="+classId+"&key="+key+"&classType="+classType;
   	   	 return false; //禁止 页面自动刷新
		});
 
	});
    
	var keyWord = $("#keyWord").val();
	
	var laypage = layui.laypage;
	laypage({
		  cont: "page",pages: "${pages!'1'}",curr: "${pageNum!'1'}",skip: false,skin: "molv",groups: 5, 
		  jump: function(e, first){ 
		    if(!first){ 
		    	 var type = $("#type").val();
		    	 var searchQuestion = $("#searchQuestion").val();
		    	 var lId = $("#lId").val();
		    	 var classId =$("#classId").val();
		    	 var classType =$("#classType").val();
		    	 var key =$("#key").val();
 		    	window.location.href="${ctx}/padPractice/detailedRecordPad?p="+e.curr+"&searchType="+type+"&searchQuestion="+searchQuestion+"&lId="+lId+"&classId="+classId+"&key="+key+"&classType="+classType;
		    }
		  }
	});
 
	
	function detailed(lId){
		 
	//	LayerOpen('详细', '1300px', '900px', '${ctx}/adminPractice/detailedRecord?lId='+lId);
	}
	    
</script>
</body>
</html>